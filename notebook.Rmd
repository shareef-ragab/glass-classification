```{r}
#install.packages('tidyverse')
#install.packages('DataExplorer')
```
```{r Library}
library(corrplot)
library(ggplot2)
library(DataExplorer)
library(e1071)
library(caret)
```
```{r read date}
date <- read.csv("glass.csv", header = TRUE)
```
```{r view date}
View(date)
date
```
```{r show num column}
colnum <- ncol(date)
print(paste("num of col : ", ncol(date)))

```
```{r show number row}
rownum <- nrow(date)
print(paste("num of row : ", nrow(date)))
```
```{r show name column}
print(colnames(date))
```
```{r show struachre date }
str(date)
```
```{r show summary date}
summary(date)
```
```{r show plot missing date beffor replace value}
plot_missing(date)
```
```{r replace 0 value to null value and show}
png("missing_value_after process.png")
date[date==0]<- NA
plot_missing(date, geom_label_args = list("size" = 4),title = "Missing Data in Glass",theme_config = list(legend.position =c("top")))
```
```{r}
date<-date[,-8:-9]
date[is.na(date)]<- 0
date
```
```{r}
plot_missing(date)
```
```{r}
table(date$Type)
```
```{r}
date$Type <-as.factor(date$Type)
str(date)
```
```{r}
png("corplot_process.png")
corrplot(cor(date[,-8]))
```
```{r}
png("boxplot.png")
boxplot(date$RI~date$Type,main ="Types of glass and the severity of its refraction",xlab = 'Type',ylab = 'RI')
```
```{r}
png("barplot.png")
dateElemn<-date[,-8]
dateElemn<-dateElemn[,-1]
sum_col<- apply(dateElemn, 2, mean)
barplot(sum_col,col ='red',main = 'average of items used' )
```
```{r}
png("plot.png")
plot(dateElemn,main ="relation  elements " )
```
```{r}
png("na_type.png")
ggplot(date, aes(x=Na, fill=Type)) + geom_density()
```
```{r}
png("mg_type.png")d
ggplot(date, aes(x=Mg, fill=Type)) + geom_density()
```
```{r}
png("al_type.png")
ggplot(date, aes(x=Al, fill=Type)) + geom_density()
```
```{r}
png("si_type.png")
ggplot(date, aes(x=Si, fill=Type)) + geom_density()
```
```{r}
png("k_type.png")
ggplot(date, aes(x=K, fill=Type)) + geom_density()
```
```{r}
png("ca_type.png")
ggplot(date, aes(x=Ca, fill=Type)) + geom_density()
```

```{r}
clusters <- kmeans(date[,1], 7)
clusters 
```
```{r}
date$RIcluster <- as.factor(clusters$cluster)
date
```
```{r}

index <- sample(rownum, 0.7 * rownum)
trainDate <- date[index,]
testDate <- date[-index,]
dim(date)
dim(trainDate)
dim(testDate)

```

```{r}
table(date$RIcluster)
table(trainDate$RIcluster)
table(testDate$RIcluster)
```

```{r}

learn_svm <- svm(RIcluster~., data=trainDate)
pre_svm <- predict(learn_svm, trainDate[,-9])
cm_svm <- confusionMatrix(pre_svm, date$RIcluster)
cm_svm
```

